# Classifying Road Quality Using Satellite Imagery in Metro Detroit
### Nabil Ahmed, David Karamardian, Trent McMullen

Final project for CS231N

This repository contains the data and code supporting our final project for Stanford's CS231N course. 
Our project involves classifying images of roads in Metro Detroit based on road quality by using 
transfer learning, contrastive learning, and network visualization techniques.

## Part 1: Dataset Preparation

The dataset underlying this project was generated by tying together information from two sources:

1. Road quality labels and GPS coordinates were obtained from the 
Southeast Michigan Council of Governments (SEMCOG) Pavement Condition dataset:
https://maps.semcog.org/PavementCondition/

2. The GPS coordinates from the SEMCOG data were used to obtain 40,000 satellite images by 
querying the Google Static Maps API. The script to obtain the images is available in DataPreprocessing.md.
Note that the DataPreprocessing.md file makes some mention of a lane classification component to the
project, but this was not explored due to time constraints. 

While the Google Static Maps API has the advantage of being free to use, this approach resulted 
in significant label noise/error. The sources of this label noise are the time gap between the date
of a satellite photo's capture and the date of the SEMCOG pavement condition evaluation, GPS coordinates
that lead to images that are not properly centered on the relevant parts of the road, and the 
low-resolution of certain satellite images.

To address the label noise, the team hand-labeled 2250 training and 450 validation images. These 
hand-labeled datasets have an equal proportion of poor, fair, and good quality roads. The team's hand-labels
were calibrated against the labels assigned by a human expert in the field of civil engineering and road
quality evaluation. The hand-labeled dataset was employed for model training and evaluation, with the 
remaining images used for analysis of clusters generated from model embeddings. 

## Part 2: Model Construction for Classification

The construction, training, and evaluation of model architectures is described in main.ipynb. 
Ultimately, a model that utilized a pretrained version of ResNet50 and an MSE ordinal regression
loss function was able to achieve acceptable levels of classification accuracy while also creating
predictions that reflected the ordinal nature of the target labels. 

## Part 3: Contrastive Learning

More to come.

## Part 4: Clustering (t-SNE) Analysis of Test Set Embeddings

More to come.
